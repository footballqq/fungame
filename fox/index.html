<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>抓狐狸 🦊</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=ZCOOL+KuaiLe&display=swap" rel="stylesheet">
</head>

<body>
    <div class="game-container">
        <header>
            <h1>🦊 <span id="holes-count-title">5</span>洞抓狐狸</h1>
            <p>小狐狸每天晚上会跳到相邻的洞口，你能抓住它吗？</p>
        </header>

        <div class="controls">
            <div class="holes-selector">
                <label for="holes-count">洞口</label>
                <select id="holes-count" aria-label="选择洞口数量"></select>
            </div>
            <div class="difficulty-toggle">
                <button id="mode-easy" class="btn mode-btn active">简单</button>
                <button id="mode-hard" class="btn mode-btn">困难</button>
            </div>
            <button id="strategy-btn" class="btn secondary" style="background-color: #9b59b6;">💡 攻略</button>
            <button id="restart-btn" class="btn secondary">重置游戏</button>
        </div>

        <div class="status-bar">
            <div id="day-display">第 <span id="day-count">1</span> 天</div>
            <div id="message">请选择一个洞口检查...</div>
        </div>

        <div class="scene">
            <div class="holes-container" id="holes-container">
                <!-- Holes generated by JS -->
            </div>
        </div>

        <div id="replay-controls" class="hidden">
            <h3>🎮 游戏回放</h3>
            <div class="playback-bar">
                <button id="prev-step" disabled>◀ 上一步</button>
                <span id="step-info">0 / 0</span>
                <button id="next-step" disabled>下一步 ▶</button>
            </div>
            <div class="result-actions">
                <button id="auto-play" class="btn primary">▶ 自动播放</button>
                <button id="share-btn" class="btn secondary">📤 分享战绩</button>
                <button id="restart-end-btn" class="btn primary">🔄 再玩一次</button>
            </div>
        </div>

        <div id="log-container">
            <div class="log-header">
                <h3>📜 抓捕记录</h3>
                <button id="copy-debug-btn" class="btn small-btn hidden" title="复制调试信息">📋 复制记录</button>
            </div>
            <ul id="game-log"></ul>
        </div>
    </div>

    <!-- Intro Modal -->
    <div id="intro-modal" class="modal">
        <div class="modal-content">
            <h2>🦊 <span id="intro-holes-count">5</span>洞抓狐狸</h2>
            <div class="intro-body">
                <p><strong>游戏规则：</strong></p>
                <ol>
                    <li>山上有 <strong><span id="intro-holes-count-inline">5</span>个洞口</strong>，小狐狸躲在其中一个。</li>
                    <li>你每天只能检查 <strong>1个洞口</strong>。</li>
                    <li>如果没抓到，天黑后狐狸会跳到 <strong>相邻</strong> 的洞口。</li>
                    <li>看看你需要几天才能抓到它！</li>
                </ol>
                <div class="difficulty-hint">
                    <p>🔥 <strong>简单模式</strong>：狐狸随机跳。</p>
                    <p>😈 <strong>困难模式</strong>：这是一只超级狡猾的狐狸，——只要你没用必胜策略，它就永远不会被抓到。</p>
                </div>
            </div>
            <button id="start-game-btn" class="btn primary big-btn">开始抓捕！</button>
        </div>
    </div>

    <!-- Strategy Modal -->
    <div id="strategy-modal" class="modal hidden">
        <div class="modal-content">
            <div class="intro-body">
                <p>这是一个经典的逻辑推理题，核心在于利用<strong>“奇偶性”</strong>来逐步缩小狐狸的藏身范围。下方详细推演以 <strong>5洞</strong> 为例。</p>

                <p>
                    当前洞口数：<strong><span id="strategy-holes-count">5</span></strong>，保证抓到最少需要
                    <strong><span id="strategy-days">6</span></strong> 天。<br>
                    按顺序检查：
                    <span class="highlight-text" id="strategy-seq"
                        style="display:block; margin: 10px 0; font-size: 1.1em;"></span>
                </p>

                <h3 style="color: #d35400; border-bottom: 2px solid #eee; padding-bottom: 5px;">必胜策略方案</h3>
                <p>按顺序检查以下洞口：<br>
                    <span class="highlight-text" style="display:block; margin: 10px 0; font-size: 1.1em;">2 ➡ 3 ➡ 4 ➡ 4
                        ➡ 3 ➡ 2</span>
                    <span class="highlight-text" style="display:block; margin: 10px 0; font-size: 1.1em;">或者 2 ➡ 3
                        ➡ 4 ➡ 2
                        ➡ 3 ➡ 4</span>
                </p>

                <h4 style="margin-top: 20px;">为什么能赢？（原理解析）</h4>
                <p>狐狸每天所在的洞口编号，其<strong>奇偶性是交替变换的</strong>。</p>

                <p><strong>第一阶段：假设狐狸开始在“偶数洞”（第1-3天）</strong></p>
                <ul style="text-align: left; background: #fdf6ec; padding: 10px 20px; border-radius: 10px;">
                    <li><strong>第1天 (查2)</strong>：若狐狸在2则胜；若没抓到，狐狸(若在偶数)只能在4。</li>
                    <li><strong>第2天 (查3)</strong>：昨晚狐狸从4移至3或5。查3，排除3。</li>
                    <li><strong>第3天 (查4)</strong>：昨晚狐狸从5移至4。查4，<strong>必抓！</strong></li>
                </ul>

                <p><strong>第二阶段：若没抓到，说明狐狸开始在“奇数洞”</strong></p>
                <p>经过3晚移动（奇→偶→奇→偶），<strong>第4天早上，狐狸一定位于“偶数洞”</strong>。此时反向重复策略：</p>
                <ul style="text-align: left; background: #e8f6f3; padding: 10px 20px; border-radius: 10px;">
                    <li><strong>第4天 (查4)</strong>：若没抓到，狐狸此时一定在2。</li>
                    <li><strong>第5天 (查3)</strong>：昨晚狐狸从2移至1或3。查3，排除3。</li>
                    <li><strong>第6天 (查2)</strong>：昨晚狐狸从1移至2。查2，<strong>必抓！</strong></li>
                </ul>

                <h4 style="margin-top: 20px;">策略总结表</h4>
                <table class="strategy-table">
                    <thead>
                        <tr>
                            <th>天数</th>
                            <th>检查</th>
                            <th>原理 (排除法)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>1</td>
                            <td><strong>2</strong></td>
                            <td>假设偶数起，排除2</td>
                        </tr>
                        <tr>
                            <td>2</td>
                            <td><strong>3</strong></td>
                            <td>锁定剩余偶数变位</td>
                        </tr>
                        <tr>
                            <td>3</td>
                            <td><strong>4</strong></td>
                            <td><strong>若偶数起，必抓</strong></td>
                        </tr>
                        <tr>
                            <td>4</td>
                            <td><strong>4</strong></td>
                            <td>转为奇数起逻辑 (变偶)</td>
                        </tr>
                        <tr>
                            <td>5</td>
                            <td><strong>3</strong></td>
                            <td>锁定剩余变位</td>
                        </tr>
                        <tr>
                            <td>6</td>
                            <td><strong>2</strong></td>
                            <td><strong>无处可逃，必抓</strong></td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <button id="close-strategy-btn" class="btn secondary big-btn">学会了！</button>
        </div>
    </div>

    <script src="script.js"></script>
</body>

</html>
