<!-- codex: 2026-02-13 新增 chesshorse：马踏遍棋盘（Knight's Tour）游戏与回归测试 -->
- [X] 新增: `chesshorse/` 国际象棋“马”走遍棋盘（默认 4×4，可选 N×N），走过格子变色不可再踩，支持“显示答案/动画演示/提示一步/撤销”，含春节元素与祝福语、玩家记录
- [X] 测试: 使用 `pytest` 覆盖 Knight's Tour 求解器的“无解/有解/路径合法性”关键场景（新增 `tests/test_chesshorse_knight_tour_solver.py`；并补 Node 单测 `chesshorse/knight_tour_solver.test.js`）
- [X] 文档: 补齐 `chesshorse/README.md`（玩法/按钮/答案与演示说明）

- [X] 新增: `history/historycards.py` 失败记录后继续处理，连续失败达到阈值才停止（默认 10）（新增 `--max-consecutive-failures`/`--stop-on-failure`）
- [X] 新增: 将失败条目汇总写入 `history/resources/cards/_errors.jsonl` 便于后续统一处理（新增 `--errors-file`，默认写到 `cards/_errors.jsonl`）
- [X] 测试: 使用 `pytest` 覆盖“继续处理/连续失败停止/错误汇总写入”3 个场景（新增 `tests/test_historycards_failure_handling.py`）
- [X] 修复: `snail/game.js` Mastermind 模式 AI 卡死，按 IMO 2024/5 三次尝试策略重写“边缘 M1 + 阶梯遇到 M2”的第三次逃脱路径，并移除自动强制放怪物逻辑
- [X] 测试: 使用 `node --test` 覆盖第三次逃脱路径规划关键分支（新增 `snail/ai_strategy.test.js`）
- [X] 体验: 用居中可爱对话框替换系统 alert，并补齐中英文文案（新增 `dialog_ok`/错误细分文案）
- [X] 适配: 改造 `snail/index.html`/`snail/style.css`，让游戏在手机与平板自适应布局与字号
- [X] 新增: 主宰模式 Stop/Resume + 可复制蜗牛日志（含决策/行动/碰撞），并在“第三次仍失败”时自动暂停提示复制日志；新增速度滑块可调蜗牛移动速度
- [X] 优化: 移除“安全/怪物”图例；主宰模式底部加引导文案与“解释”按钮（含棋盘+箭头演示为什么 3 次最优）；若第一轮扫描未放怪物则强制在最后格揭示怪物并弹出规则提示
- [X] 修复: `snail/game.js` 主宰模式“已走过=安全格”禁放怪物（新增中英文提示文案 + 校验函数 + Node 单测）
- [X] 优化: `snail/game.js` 冒险模式允许从任意“已确认安全格”（走过且未揭示怪物）出发（新增起点校验函数 + Node 单测）
- [X] 体验: 主宰模式蜗牛到终点改为失败提示（含探索次数 N）
- [X] 体验: 主宰模式第一轮未放怪物时弹窗暂停，玩家确认后再进入下一次探索（对话框支持 `onOk` 回调）
- [X] 测试: 使用 `node --test` 覆盖失败提示文案与“暂停不自动进入下一次”分支（新增纯函数 + 单测）
- [X] 新增: `snail/game.js` 冒险模式作弊：玩家选择蜗牛时，移动前动态重排怪物；若存在合法布局则强制下一步踩雷（新增 `tryBuildAdventureCheatMonsterLayout`）
- [X] 测试: 使用 `node --test` 覆盖冒险模式作弊布局求解器关键分支（更新 `snail/ai_strategy.test.js`）
- [X] 修复: `history/historycards.py` 兼容缺依赖环境（`pypinyin`/`openai` 缺失时可导入，便于 `pytest` 运行）
